<!DOCTYPE html>
<html>
<head>
  <title>Soccer Player Guessing Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }

    h1 {
      text-align: center;
    }

    #guess-form {
      text-align: center;
      margin-top: 20px;
    }

    #result {
      text-align: center;
      margin-top: 20px;
    }

    #player-image {
      max-width: 300px;
      margin: 20px auto;
      display: block;
    }

    #reveal-button {
      display: block;
      margin: 20px auto;
      text-align: center;
    }

  </style>
</head>
<body>
  <h1>Soccer Player Guessing Game</h1>

  <div id="guess-form">
    <label for="guess">Guess a soccer player:</label>
    <input type="text" id="guess" placeholder="Enter player name">
    <button onclick="checkGuess()">Submit</button>
  </div>

  <div id="result"></div>

  <button id="reveal-button" onclick="revealPlayer()">Reveal Correct Player</button>

  <script>
    var csvURL = 'test_tmarkt.csv';
    var resultDiv = document.getElementById("result");
    var revealButton = document.getElementById("reveal-button");

    fetch(csvURL)
      .then(response => response.text())
      .then(data => {
        var lines = data.trim().split('\n');
        var headers = lines[0].split(',');
        var players = [];

        for (var i = 1; i < lines.length; i++) {
          var currentLine = lines[i].split(',');
          var player = {};

          for (var j = 0; j < headers.length; j++) {
            player[headers[j]] = currentLine[j];
          }

          players.push(player);
        }

        // Call the function to start the game with the parsed player data
        startGame(players);
      })
      .catch(error => {
        console.error('Error fetching CSV data:', error);
      });

    var playerIndex;
    var player;
    var guessInput = document.getElementById("guess");
    var guessButton = document.querySelector("button");

    function startGame(players) {
      playerIndex = Math.floor(Math.random() * players.length);
      player = players[playerIndex];
      guessInput.disabled = false;
      resultDiv.innerHTML = "";
      revealButton.style.display = "inline-block";
    }

    function checkGuess() {
      var guess = sanitizeInput(guessInput.value.trim());

      if (guess.toLowerCase() === sanitizeInput(player.name.toLowerCase())) {
        resultDiv.innerHTML = "<p>Correct! The player's name is " + player.name + ".</p><img id='player-image' src='" + player.image_url + "' alt='Player Image'>";
        guessInput.disabled = true;
        revealButton.style.display = "none";
      } else {
        resultDiv.innerHTML = "<p>Incorrect. Keep guessing!</p>";
      }

      guessInput.value = "";
    }

    function revealPlayer() {
      resultDiv.innerHTML = "<p>The correct player is " + player.name + ".</p><img id='player-image' src='" + player.image_url + "' alt='Player Image'>";
      revealButton.style.display = "none";
    }

    function sanitizeInput(input) {
      return input.normalize("NFD").replace(/\p{Diacritic}/gu, "");
    }
  </script>
</body>
</html>